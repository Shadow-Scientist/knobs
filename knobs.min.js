!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Knobs=t()}(this,(function(){"use strict";function e(...t){const a=e=>e&&"object"==typeof e;return t.reduce(((t,o)=>(Object.keys(o).forEach((r=>{var n=t[r],i=o[r];Array.isArray(n)&&Array.isArray(i)?t[r]=n.concat(...i):t[r]=a(n)&&a(i)?e(n,i):i})),t)),{})}var t=window.requestAnimationFrame||(e=>window.setTimeout(e,1e3/60));function a(t){if(!t||!window.CSS||!CSS.supports("top","var(--a)"))return this;this.settings=e({},this._defaults,{appendTo:document.body},t),this.DOM={},this.build()}return a.prototype={_types:["range","color","checkbox","text"],_defaults:{visible:0,live:!0,theme:{flow:"horizontal",styles:"",RTL:!1,position:"top right",primaryColor:"#0366D6",backgroud:"rgba(0,0,0,1)",textColor:"white",border:"none"}},getCSSVariables({flow:e,styles:t,RTL:a,position:o,...r}){var n,i="";for(n in r)i+=`--${n}:${r[n]};`;return console.log(i),i},parseHTML:e=>(new DOMParser).parseFromString(e.trim(),"text/html").body.firstElementChild,templates:{scope(){const{visible:e,knobs:t,live:a,theme:o}=this.settings;return`\n        <aside class='knobs' data-position='${o.position}' data-flow='${o.flow}'>\n          <input hidden type='checkbox' ${e?"checked":""} id='knobsToggle' />\n          <label title='Demo Settings' ${2==e?"style='display:none'":""} for='knobsToggle'>⚙️</label>\n          <form class='knobs__labels'>\n            <fieldset>\n            ${t.map(this.templates.knob.bind(this)).join("")}\n            ${this.templates.knob.call(this)}\n            </fieldset>\n            <section class='knobs__controls'>\n              <a class='poweredBy' href='https://github.com/yairEO/knobs' target='_blank'>Powered by <em>Knobs</em></a>\n              <input type="reset" value="↩ Reset">\n              ${a?"":'<input type="submit" value="Apply">'}\n            </section>\n          </form>\n        </aside>\n      `},knob(e){return e&&e.type?`<div class='knobs__knob'>\n            <button type='button' name='${e.__name}' class='knobs__knob__reset' title='reset'>↩</button>\n            <label data-type='${e.type}'>\n              <div class='knobs__label' ${e.cssVar&&e.cssVar[1]?`data-type='${e.cssVar[1]}'`:""}>${e.label}</div>\n              <div class='knobs__inputWrap'>\n                ${"range"==e.type?`\n                <div class="range" style="--step:${e.step||1}; --min:${e.min}; --max:${e.max}; --value:${e.value}; --text-value:'${e.value}'">\n                  <input type="range" ${this.knobAttrs(e)} oninput="this.parentNode.style.setProperty('--value',this.value); this.parentNode.style.setProperty('--text-value', JSON.stringify(this.value))">\n                  <output></output>\n                  <div class='range__progress'></div>\n                </div>`:`<div><input type='${e.type}' ${this.knobAttrs(e)}></div>`}\n              </div>\n            </label>\n          </div>\n        `:e&&"string"==typeof e?`<div class='knobs__seperator'>&nbsp;&nbsp;${e}&nbsp;&nbsp;</div>`:"<hr/>"}},knobAttrs(e){var t=`name="${e.__name}"`,a=["label","type","onchange","cssvar"];for(var o in e)a.includes(o.toLowerCase())||(t+=` ${o}="${e[o]}"`);return t},getKnobDataByName(e){return this.settings.knobs.filter(Boolean).find((t=>t.__name==e))},getInputByName(e){return this.DOM.scope.querySelector(`input[name="${e}"`)},onChange(e){var a,o=this.getKnobDataByName(e.target.name),r="input"==e.type&&o&&"range"!=o.type,n=o&&"checkbox"==o.type;o&&(n||this.settings.live)&&("input"==e.type&&r||(a={...o,value:e.target.value},t((()=>this.updateDOM(a))),"function"==typeof o.onChange&&o.onChange(e,a)))},updateDOM({cssVar:e,value:t,type:a,__name:o}){if(e&&e.length){var[r,n,i]=e,s=i||this.settings.CSSVarTarget,l=this.getInputByName(o),p="setProperty";if("checkbox"!=a||l.checked||(p="removeProperty"),s instanceof HTMLElement&&(s=[s]),s&&s.length&&void 0!==t&&r)for(let e of s)e.style[p]("--"+r,t+(n||""))}},resetAll(e){(e||this.settings.knobs).forEach((e=>{if(e&&e.type){var t="checkbox"==e.type,a="range"==e.type,o={target:{value:e.value,name:e.__name}},r=this.getInputByName(e.__name);t?r.checked=!!e.checked:r.value=e.value,a&&r.parentNode.style.setProperty("--value",e.value),this.onChange(o)}}))},resetKnobByName(e){this.resetAll([this.getKnobDataByName(e)])},generateIds(){this.settings.knobs.forEach((e=>{e&&e.type&&(e.__name=e.label.replace("/ /g","-")+Math.random().toString(36).slice(-6))}))},onSubmit(e){e.preventDefault();var t=[...e.target.elements];return this.settings.live=!0,t.forEach((e=>this.onChange({target:{value:e.value,name:e.name}}))),this.settings.live=!1,!1},onClick(e){var t,a=e.target;t="knobs__knob__reset",a.classList.contains(t)&&this.resetKnobByName(a.name)},toggle(e){void 0===e&&(e=!this.DOM.mainToggler.checked),e&&(this.DOM.iframe.style.setProperty("--knobsWidth","1000px"),this.DOM.iframe.style.setProperty("--knobsHeight","1000px"));var t=(e?"set":"remove")+"Property",{clientWidth:a,clientHeight:o}=this.DOM.scope;this.DOM.iframe.style[t]("--knobsWidth",a+"px"),this.DOM.iframe.style[t]("--knobsHeight",o+"px"),this.DOM.mainToggler.checkd=e},build(){this.settings.knobs&&this.settings.knobs.length&&(this.generateIds(),this.createIframe(),this.bindEvents(),this.toggle(this.DOM.mainToggler.checked),this.resetAll())},createIframe(){var e,t,a=this.settings.theme;this.DOM.iframe=document.createElement("iframe"),this.DOM.iframe.setAttribute("class","knobsIframe"),this.DOM.iframe.style.cssText=`\n        border: none;\n        position: fixed;\n        z-index: 999999;\n        ${(a.position+" ").split(" ").join(":0;")}\n        width: var(--knobsWidth, 35px);\n        height: var(--knobsHeight, 30px);\n    `,this.settings.appendTo.appendChild(this.DOM.iframe),(e=this.DOM.iframe.contentWindow.document).open(),e.write(this.templates.scope.call(this)),t=this.getCSSVariables(a),t+="label,button,input{cursor:pointer;font:12px Arial, sans-serif}body,form{padding:0;margin:0}.poweredBy{float:left;text-decoration:none;color:inherit;padding:3px;font-size:10px;opacity:.5;transition:.15s}.poweredBy:hover{color:var(--primaryColor);opacity:1}#knobsToggle:checked ~ *{transform:none;transition:calc(var(--in-duration) * 1s) var(--in-easing)}#knobsToggle:checked ~ * fieldset{transform:none;opacity:1;transition:calc(var(--in-duration) * 1s) calc(var(--in-duration) * .5s) ease-out}.knobs{--knobs-gap: 3px;--in-easing: cubic-bezier(.75,0,.35,1);--in-duration: .3;--color-size: 22px;--LTR-Bool: 1;font:12px/1 'Fira Sans Condensed', sans-serif;color:var(--textColor);position:fixed;z-index:999999;top:0;right:0}.knobs[data-flow='compact']{--color-size: 16px}.knobs[data-flow='compact'] label[data-type='range']{flex-flow:column}.knobs[data-flow='compact'] label[data-type='range'] .knobs__label{margin:0;padding:0}.knobs label{user-select:none;cursor:pointer}.knobs>label{position:absolute;top:10px;right:10px;font-size:20px;line-height:1;z-index:999}.knobs__labels{background:var(--backgroud);border:var(--border);transform:translateX(calc(100% * var(--LTR-Bool)))}.knobs__labels fieldset{display:table;border:0;padding:0;margin:0;padding:30px 12px 12px;opacity:0;transform:translateX(calc(15% * var(--LTR-Bool)))}.knobs__seperator{display:flex;align-items:center;margin:1.2em 0 .7em;font-weight:700}.knobs__seperator::before,.knobs__seperator::after{content:'';height:1px;background:var(--textColor);flex:1;opacity:.25}.knobs__labels hr{border:0;border-top:1px solid var(--textColor);opacity:.25}.knobs__knob{display:flex;position:relative}.knobs__knob__reset{margin-right:5px;color:inherit;background:none;border:0;padding:0;cursor:pointer;opacity:0;margin-left:-10px;margin-bottom:var(--knobs-gap, 6px);align-self:flex-end;transition:.1s;outline:none}.knobs__label::after{content:attr(data-type);opacity:.5;margin-left:1ch}.knobs__knob:hover .knobs__knob__reset{opacity:.4}.knobs__knob:hover .knobs__knob__reset:hover{opacity:1}.knobs__labels label{flex:1;display:flex}.knobs__labels label>*{padding:var(--knobs-gap, 6px) 0}.knobs__labels .range,.knobs__labels input[type=text]{min-width:200px}.knobs__label{margin-right:2ch;white-space:nowrap;display:flex;align-items:center}.knobs__labels label>:last-child{flex:1;text-align:right}label[data-type=\"color\"]>.knobs__inputWrap>div{display:inline-block;border-radius:50px;overflow:hidden;width:var(--color-size);height:var(--color-size);transition:0.3s var(--in-easing)}label[data-type=\"color\"]:hover>.knobs__inputWrap>div{padding:0 1.3em}input[type=\"color\"]{-webkit-appearance:none;appearance:none;border:0;padding:0;transform:scale(100);background:none;cursor:pointer}.knobs[data-position~='bottom']>label{top:0}.knobs[data-position~='bottom'][data-position~='right'] .knobs__controls{padding-right:40px}.knobs[data-position~='bottom'] #knobsToggle:checked+label{top:auto;bottom:10px}.knobs[data-position~='left']{--LTR-Bool: -1}.knobs[data-position~='left']>label{right:3px}.knobs[data-position~='left'] #knobsToggle:checked+label{left:10px;right:auto}.knobs[data-position~='left'] .knobs__controls>:first-child:not(:only-child){margin-left:40px}.knobs .range{--primaryColor: inherit;--value-active-color: white;--value-background: transparent;--progress-color: #444;--thumb-size: 20px;--track-height: calc(var(--thumb-size)/3);--thumb-shadow: 0 0 3px rgba(0,0,0,.2);--ticks-thickness: 1px;--ticks-height: 0px;--show-min-max: none;color:transparent}.range{--primaryColor: #0366D6;--value-active-color: white;--value-background: white;--value-font: 700 12px/1 Arial;--progress-color: #EEE;--progress-shadow: 2px 2px 4px rgba(0,0,0, .1) inset;--fill-color: var(--primaryColor);--thumb-size: 16px;--track-height: calc(var(--thumb-size)/2);--thumb-shadow: 0 0 3px rgba(0,0,0,.2);--ticks-thickness: 1px;--ticks-height: 5px;--ticks-color: silver;--step: 1;--ticks-count: (var(--max) - var(--min)) / var(--step);--maxTicksAllowed: 30;--too-many-ticks: Min(1, Max(var(--ticks-count) - var(--maxTicksAllowed), 0));--x-step: Max( var(--step), var(--too-many-ticks) * (var(--max) - var(--min)) );--tickInterval: 100/((var(--max) - var(--min)) / var(--step)) * var(--tickEvery, 1);--tickIntervalPerc: calc((100% - var(--thumb-size))/( (var(--max) - var(--min)) / var(--x-step) ) * var(--tickEvery, 1));--completed: calc((var(--value) - var(--min) ) / (var(--max) - var(--min)) * 100);--LTR: 1;display:inline-block;height:Max(var(--track-height), var(--thumb-size));background:linear-gradient(to right, var(--ticks-color) var(--ticks-thickness), transparent 1px) repeat-x;background-size:var(--tickIntervalPerc) var(--ticks-height);background-position-x:calc(var(--thumb-size)/2);background-position-y:var(--flip-y, bottom);position:relative;z-index:1;padding-bottom:var(--flip-y, var(--ticks-height));padding-top:calc(var(--flip-y) * var(--ticks-height))}[dir=rtl] .range{--LTR: -1}.range[data-ticks-position=top]{--flip-y: 1}.range::before,.range::after{--offset: calc(var(--thumb-size)/2);content:counter(x);display:var(--show-min-max, block);font:12px Arial;position:absolute;bottom:var(--flip-y, -2.5ch);top:calc(-2.5ch * var(--flip-y));opacity:var(--min-max-opacity, 0.5);pointer-events:none}.range::before{counter-reset:x var(--min);left:var(--offset);transform:translateX(calc(-50% * var(--LTR)))}[dir=rtl] .range::before{left:auto;right:var(--offset)}.range::after{counter-reset:x var(--max);right:var(--offset);transform:translateX(calc(50% * var(--LTR)))}[dir=rtl] .range::after{right:auto;left:var(--offset)}.range__progress{position:absolute;left:0;top:calc(50% - var(--ticks-height)/2);transform:var(--flip-y, translateY(-50%) translateZ(0));width:100%;height:calc(var(--track-height));pointer-events:none;z-index:-1;box-shadow:var(--progress-shadow);border-radius:20px;background:var(--fill-color, white)}.range__progress::after{content:\"\";display:block;margin-left:auto;margin-right:-1px;width:calc((100% - var(--completed) * 1%) + (var(--completed)/100) * var(--thumb-size)/2);height:100%;background:var(--progress-color, #EEE);box-shadow:inherit;border-radius:0 20px 20px 0}[dir=rtl] .range__progress::after{margin-right:auto;margin-left:-1px;border-radius:20px 0 0 20px}.range>input{-webkit-appearance:none;width:100%;height:var(--thumb-size);margin:0;cursor:-webkit-grab;cursor:grab;outline:none;background:none}.range>input::-webkit-slider-thumb{appearance:none;height:var(--thumb-size);width:var(--thumb-size);border-radius:50%;background:var(--thumb-color, white);border:1px solid silver;box-shadow:var(--inner-shadow, 0 0),var(--thumb-shadow)}.range>input::-moz-slider-thumb{appearance:none;height:var(--thumb-size);width:var(--thumb-size);border-radius:50%;background:var(--thumb-color, white);border:1px solid silver;box-shadow:var(--inner-shadow, 0 0),var(--thumb-shadow)}.range>input::-ms-thumb{appearance:none;height:var(--thumb-size);width:var(--thumb-size);border-radius:50%;background:var(--thumb-color, white);border:1px solid silver;box-shadow:var(--inner-shadow, 0 0),var(--thumb-shadow)}.range>input:active{cursor:grabbing;--thumb-color: var(--fill-color);--inner-shadow: 0 0 0 calc(var(--thumb-size)/4) inset white}.range>input:active+output{transition:0s}.range>input:hover+output{--value-background: var(--primaryColor);color:var(--value-active-color);transform:translate(var(--x-offset), 0);box-shadow:0 0 0 3px var(--value-background)}.range>output{--x-offset: calc(var(--completed) * -1% * var(--LTR));--pos: calc(((var(--value) - var(--min))/(var(--max) - var(--min))) * 100%);pointer-events:none;position:absolute;z-index:5;background:var(--value-background);border-radius:10px;padding:0 4px;top:-3ch;left:var(--pos);transform:translate(var(--x-offset), 6px);transition:all 0.12s ease-out, left 0s, top 0s}[dir=rtl] .range>output{left:auto;right:var(--pos)}.range>output::after{content:var(--text-value);font:var(--value-font)}.knobs__controls{text-align:right;padding:0 12px 12px}.knobs__controls>input{color:black;margin-left:1em}\n"+a.styles,e.head.insertAdjacentHTML("beforeend",`<style>${t}</style>`),e.close(),this.DOM.scope=e.body.firstElementChild,this.DOM.form=this.DOM.scope.querySelector("form"),this.DOM.mainToggler=e.getElementById("knobsToggle")},bindEvents(){this.eventsRefs={onChange:this.onChange.bind(this),onReset:this.resetAll.bind(this,null),onSubmit:this.onSubmit.bind(this),onClick:this.onClick.bind(this)};var{onChange:e,onReset:t,onSubmit:a,onClick:o}=this.eventsRefs;this.DOM.form.addEventListener("change",e),this.DOM.form.addEventListener("input",e),this.DOM.form.addEventListener("reset",t),this.DOM.form.addEventListener("submit",a),this.DOM.scope.addEventListener("click",o),this.DOM.mainToggler.addEventListener("change",(e=>this.toggle(e.target.checked)))}},a}));
