!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Knobs=t()}(this,(function(){"use strict";function e(e){return e+""=="[object Object]"}function t(o,...a){if(!a.length)return o;const n=a.shift();if(e(o)&&e(n))for(const a in n)e(n[a])?(o[a]||Object.assign(o,{[a]:{}}),t(o[a],n[a])):Object.assign(o,{[a]:n[a]});return t(o,...a)}function o(e){if(e&&e.type)return`<div class='knobs__knob'>\n        <label data-type='${e.type}'>\n          <div class='knobs__knob__label' ${e.cssVar&&e.cssVar[1]?`data-type='${e.cssVar[1]}'`:""}>${e.label}</div>\n          <div class='knobs__knob__inputWrap'>\n            ${a.call(this,e)}\n          </div>\n        </label>\n        <button type='button' name='${e.__name}' class='knobs__knob__reset' title='Reset'>↩</button>\n      </div>\n    `}function a(e){return"range"==e.type?`\n      <div class="range" style="--step:${e.step||1}; --min:${e.min}; --max:${e.max}; --value:${e.value}; --text-value:'${e.value}'">\n        <input type="range" ${this.knobAttrs(e)}>\n        <output></output>\n        <div class='range__progress'></div>\n      </div>`:"checkbox"==e.type?`\n      <div class="switch">\n        <input type='${e.type}' ${this.knobAttrs(e)} class="switch__input">\n        <div class='switch__gfx'></div>\n      </div>`:`<div><input type='${e.type}' ${this.knobAttrs(e)}></div>`}var n=window.requestAnimationFrame||(e=>window.setTimeout(e,1e3/60));function r(o){if(!window.CSS||!CSS.supports("top","var(--a)"))return this;const{knobs:a,...n}=o||{};this.knobs=a?a.map((t=>t.cssVar?{...t,cssVar:[...t.cssVar]}:e(t)?{...t}:t)):[],this.settings=t({...this._defaults,appendTo:document.body},n),this.DOM={},this.state={},this.build()}return r.prototype={_types:["range","color","checkbox","text"],_defaults:{visible:0,live:!0,theme:{flow:"horizontal",styles:"",RTL:!1,position:"top right",primaryColor:"#0366D6","range-value-background":"#0366D6",background:"rgba(0,0,0,1)",textColor:"white",border:"none"}},getCSSVariables({flow:e,styles:t,RTL:o,position:a,...n}){var r,i="";for(r in n)i+=`--${r}:${n[r]}; `;return i},parseHTML:e=>(new DOMParser).parseFromString(e.trim(),"text/html").body.firstElementChild,templates:{scope:function(){const{visible:e,live:t,theme:o}=this.settings;return`\n    <aside class='knobs' data-position='${o.position}' data-flow='${o.flow}'>\n      <input hidden type='checkbox' ${e?"checked":""} id='knobsToggle' />\n      <label title='Demo Settings' ${2==e?"style='display:none'":""} for='knobsToggle'>⚙️</label>\n      <form class='knobs__labels'>\n        \x3c!-- Knobs goes here --\x3e\n        <section class='knobs__controls'>\n          <a class='poweredBy' href='https://github.com/yairEO/knobs' target='_blank'>Get <em>Knobs</em></a>\n          <input type="reset" value="↩ Reset">\n          ${t?"":'<input type="submit" value="Apply">'}\n        </section>\n      </form>\n    </aside>\n  `},knob:o,fieldset:function(t){var a,n;return e(t[0])?n=t:([a,...n]=t,a=function({label:e,checked:t}){var o=e.replace(/ /g,"-")+Math.random().toString(36).slice(-6);return`<input hidden id="${o}" type="checkbox" ${t?"checked":""} class="toggleSection">\n          <label class='knobs__legend' for="${o}" title="Expand/Collapse">${e}</label>`}(a instanceof Array?{label:a[0],checked:!!a[1]}:{label:a,checked:!0})),`<fieldset>\n    ${a||""}\n    <div class="fieldset__group">\n      ${n.map(o.bind(this)).join("")}\n    </div>\n  </fieldset>`}},knobAttrs(e){var t=`name="${e.__name}"`,o=["label","type","onchange","cssvar","__name"];for(var a in e)o.includes(a.toLowerCase())||(t+=` ${a}="${e[a]}"`);return t},getKnobDataByName(e){return this.knobs.filter(Boolean).find((t=>t.__name==e))},getInputByName(e){return this.DOM.scope.querySelector(`input[name="${e}"`)},getKnobElm(e){return this.getInputByName(e).closest(".knobs__knob")},updateDOM({cssVar:e,value:t,type:o,__name:a}){if(e&&e.length){var[n,r,i]=e,s=i||this.settings.CSSVarTarget,l=this.getInputByName(a),c="setProperty";if("checkbox"==o&&l&&!l.checked&&(c="removeProperty"),Object.prototype.toString.call(s).includes("Element")&&(s=[s]),s&&s.length&&void 0!==t&&n)for(let e of s)e.style[c]("--"+n,t+(r||""))}},resetAll(e){(e||this.knobs).forEach((e=>{if(e&&e.type){var t,o="checkbox"==e.type,a="range"==e.type,n=this.getInputByName(e.__name),r={target:n};t=o?n.checked=!!e.checked:n.value=e.value,this.setResetKnobTitle(e.__name,t),a&&n.parentNode.style.setProperty("--value",e.value),this.onInput(r),this.onChange(r)}}))},setResetKnobTitle(e,t){try{t="Reset to "+t,this.getKnobElm(e).querySelector(".knobs__knob__reset").title=t}catch(e){}},resetKnobByName(e){this.setKnobChangedFlag(this.getKnobElm(e),!1),this.resetAll([this.getKnobDataByName(e)])},generateIds(){this.knobs.forEach((e=>{e&&e.type&&(e.__name=e.label.replace("/ /g","-")+Math.random().toString(36).slice(-6))}))},onSubmit(e){e.preventDefault();var t=e.target.querySelectorAll("input");return this.settings.live=!0,t.forEach((e=>this.onChange({target:{value:e.value,name:e.name}}))),this.settings.live=!1,!1},onClick(e){var t,o=e.target;t="knobs__knob__reset",o.classList.contains(t)&&this.resetKnobByName(o.name)},calculateGroupsHeights(){this.DOM.form.querySelectorAll(".fieldset__group").forEach((e=>{e.style.setProperty("--height",e.clientHeight)}))},setIframeHeight(e){var t=e||void 0===e?"setProperty":"removeProperty",o=this.DOM.iframe.style;"setProperty"==t&&(o.setProperty("--knobsWidth","1000px"),o.setProperty("--knobsHeight","1000px"));var{clientWidth:a,clientHeight:n}=this.DOM.scope;o[t||"setProperty"]("--knobsWidth",a+"px"),o[t||"setProperty"]("--knobsHeight",n+"px")},toggle(e){void 0===e&&(e=!this.DOM.mainToggler.checked);var t=(e?"set":"remove")+"Property";this.state.visible=e,this.setIframeHeight(t),this.DOM.mainToggler.checked=e},build(){this.createIframe(),this.bindEvents()},createIframe(){var e,t,o=this.settings.theme;this.DOM.iframe=document.createElement("iframe"),this.DOM.iframe.setAttribute("class","knobsIframe"),this.DOM.iframe.style.cssText=`\n        border: none;\n        position: fixed;\n        z-index: 999999;\n        ${(o.position+" ").split(" ").join(":0;")}\n        width: var(--knobsWidth, 35px);\n        height: var(--knobsHeight, 30px);\n    `,this.settings.appendTo.appendChild(this.DOM.iframe),(e=this.DOM.iframe.contentWindow.document).open(),e.write(this.templates.scope.call(this)),t=`.knobs{ ${this.getCSSVariables(o)} }`,t+="label,button,input{cursor:pointer;font:12px Arial, sans-serif}body,form{padding:0;margin:0}.poweredBy{float:left;text-decoration:none;color:inherit;padding:3px;font-size:10px;opacity:.5;transition:.15s}.poweredBy:hover{color:var(--primaryColor);opacity:1}#knobsToggle:checked ~ .knobs__labels{transform:none;transition:calc(var(--in-duration) * 1s) var(--in-easing)}#knobsToggle:checked ~ .knobs__labels fieldset,#knobsToggle:checked ~ .knobs__labels .knobs__controls{transform:none;opacity:1;transition:calc(var(--in-duration) * 1s) calc(var(--in-duration) * .5s) ease-out}.knobs{--knobs-gap: 3px;--side-pad: 12px;--in-easing: cubic-bezier(.75,0,.35,1);--in-duration: .3;--color-size: 20px;--LTR-Bool: 1;font:12px/1 'Fira Sans Condensed', sans-serif;color:var(--textColor);position:fixed;z-index:999999;top:0;right:0}.knobs[data-flow='compact']{--color-size: 16px}.knobs[data-flow='compact'] label[data-type='range']{flex-flow:column}.knobs[data-flow='compact'] label[data-type='range'] ~ .knobs__knob__reset{align-self:flex-start}.knobs[data-flow='compact'] label[data-type='range'] .knobs__label{margin:0;padding:0}.knobs label{user-select:none;cursor:pointer}.knobs>label{position:absolute;top:10px;right:10px;font-size:20px;line-height:1;z-index:1}.knobs__labels{background:var(--background);border:var(--border);transform:translateX(calc(100% * var(--LTR-Bool)));overflow:hidden}.knobs__labels fieldset{display:table;border:0;padding:0;margin:var(--side-pad);opacity:0;transform:translateX(calc(22% * var(--LTR-Bool)));overflow:hidden}.knobs__labels fieldset:first-child{padding-top:30px}.knobs__labels .fieldset__group{transition:0.33s cubic-bezier(0.45, 0, 0.2, 1)}.knobs__labels hr{border:0;border-top:1px solid var(--textColor);opacity:.25}.knobs__labels hr:last-of-type{margin-bottom:0}.knobs__labels label{order:5;flex:1;display:flex;position:relative;z-index:1;background:var(--background)}.knobs__labels label>*{padding:var(--knobs-gap, 6px) 0}.knobs__labels .range,.knobs__labels input[type=text]{min-width:200px}.knobs__labels label>:last-child{flex:1;text-align:right}.knobs__legend{display:flex;align-items:center;margin:0 0 var(--side-pad);font-weight:700;opacity:.66;cursor:pointer;transition:0.2s cubic-bezier(0.45, 0, 0.2, 1)}.knobs__legend::before,.knobs__legend::after{content:'';height:1px;background:var(--textColor);flex:1;opacity:.5;transition:inherit}.knobs__legend::before{margin-right:2ch}.knobs__legend::after{margin-left:2ch}.knobs__legend:hover{opacity:.85}.knobs__legend:hover::before{margin-right:6ch}.knobs__legend:hover::after{margin-left:6ch}.knobs__knob{display:flex;position:relative}.knobs__knob:hover .knobs__knob__label{opacity:1}.knobs__knob[data-changed] .knobs__knob__reset{opacity:.33;user-select:auto}.knobs__knob[data-changed] .knobs__knob__reset:hover{opacity:1;background:var(--textColor);color:var(--background);transition:0s}.knobs__knob__reset{order:0;user-select:none;margin-right:.5em;padding:0;align-self:center;color:inherit;background:none;border:0;cursor:pointer;opacity:0;outline:none;border-radius:50%;width:2ch;height:2ch;transition:.15s ease-out}.knobs__knob__label{margin-right:2ch;white-space:nowrap;display:flex;align-items:center;opacity:.8;transition:80ms}.knobs__knob__label::after{content:attr(data-type);opacity:.5;margin-left:1ch}.knobs .toggleSection:not(:checked) ~ .fieldset__group{opacity:0;margin-top:calc(-1em + var(--height) * -1px);text-shadow:0px 3px 2px}.knobs[data-position~='bottom']>label{top:0}.knobs[data-position~='bottom'][data-position~='right'] .knobs__controls{padding-right:40px}.knobs[data-position~='bottom'] #knobsToggle:checked+label{top:auto;bottom:10px}.knobs[data-position~='left']{--LTR-Bool: -1}.knobs[data-position~='left']>label{right:3px}.knobs[data-position~='left'] #knobsToggle:checked+label{left:10px;right:auto}.knobs[data-position~='left'] .knobs__controls>:first-child:not(:only-child){margin-left:26px}.knobs .range{--fill-color: var(--primaryColor);--primaryColor: var(--range-value-background);--value-active-color: #FFF;--value-background: transparent;--progress-color: #444;--thumb-size: 20px;--track-height: calc(var(--thumb-size)/3);--thumb-shadow: 0 0 3px rgba(0,0,0,.2);--ticks-thickness: 1px;--ticks-height: 0px;--show-min-max: none;color:transparent}.range{--primaryColor: #0366D6;--value-active-color: white;--value-background: white;--value-font: 700 12px/1 Arial;--progress-color: #EEE;--progress-shadow: 2px 2px 4px rgba(0,0,0, .1) inset;--fill-color: var(--primaryColor);--thumb-size: 16px;--track-height: calc(var(--thumb-size)/2);--thumb-shadow: 0 0 3px rgba(0,0,0,.2);--ticks-thickness: 1px;--ticks-height: 5px;--ticks-color: silver;--step: 1;--ticks-count: (var(--max) - var(--min)) / var(--step);--maxTicksAllowed: 30;--too-many-ticks: Min(1, Max(var(--ticks-count) - var(--maxTicksAllowed), 0));--x-step: Max( var(--step), var(--too-many-ticks) * (var(--max) - var(--min)) );--tickInterval: 100/((var(--max) - var(--min)) / var(--step)) * var(--tickEvery, 1);--tickIntervalPerc: calc((100% - var(--thumb-size))/( (var(--max) - var(--min)) / var(--x-step) ) * var(--tickEvery, 1));--completed: calc((var(--value) - var(--min) ) / (var(--max) - var(--min)) * 100);--LTR: 1;display:inline-block;height:Max(var(--track-height), var(--thumb-size));background:linear-gradient(to right, var(--ticks-color) var(--ticks-thickness), transparent 1px) repeat-x;background-size:var(--tickIntervalPerc) var(--ticks-height);background-position-x:calc(var(--thumb-size)/2);background-position-y:var(--flip-y, bottom);position:relative;z-index:1;padding-bottom:var(--flip-y, var(--ticks-height));padding-top:calc(var(--flip-y) * var(--ticks-height))}[dir=\"rtl\"] .range{--LTR: -1}.range[data-ticks-position='top']{--flip-y: 1}.range::before,.range::after{--offset: calc(var(--thumb-size)/2);content:counter(x);display:var(--show-min-max, block);font:12px Arial;position:absolute;bottom:var(--flip-y, -2.5ch);top:calc(-2.5ch * var(--flip-y));opacity:var(--min-max-opacity, 0.5);pointer-events:none}.range::before{counter-reset:x var(--min);left:var(--offset);transform:translateX(calc(-50% * var(--LTR)))}[dir='rtl'] .range::before{left:auto;right:var(--offset)}.range::after{counter-reset:x var(--max);right:var(--offset);transform:translateX(calc(50% * var(--LTR)))}[dir='rtl'] .range::after{right:auto;left:var(--offset)}.range__progress{position:absolute;left:0;top:calc(50% - var(--ticks-height)/2);transform:var(--flip-y, translateY(-50%) translateZ(0));width:100%;height:calc(var(--track-height));pointer-events:none;z-index:-1;box-shadow:var(--progress-shadow);border-radius:20px;background:var(--fill-color, white)}.range__progress::after{content:'';display:block;margin-left:auto;margin-right:-1px;width:calc((100% - var(--completed) * 1%) + (var(--completed)/100) * var(--thumb-size)/2);height:100%;background:var(--progress-color, #EEE);box-shadow:inherit;border-radius:0 20px 20px 0}[dir=\"rtl\"] .range__progress::after{margin-right:auto;margin-left:-1px;border-radius:20px 0 0 20px}.range>input{-webkit-appearance:none;width:100%;height:var(--thumb-size);margin:0;cursor:-webkit-grab;cursor:grab;outline:none;background:none}.range>input::-webkit-slider-thumb{appearance:none;height:var(--thumb-size);width:var(--thumb-size);border-radius:50%;background:var(--thumb-color, white);border:1px solid silver;box-shadow:var(--inner-shadow, 0 0),var(--thumb-shadow)}.range>input::-moz-slider-thumb{appearance:none;height:var(--thumb-size);width:var(--thumb-size);border-radius:50%;background:var(--thumb-color, white);border:1px solid silver;box-shadow:var(--inner-shadow, 0 0),var(--thumb-shadow)}.range>input::-ms-thumb{appearance:none;height:var(--thumb-size);width:var(--thumb-size);border-radius:50%;background:var(--thumb-color, white);border:1px solid silver;box-shadow:var(--inner-shadow, 0 0),var(--thumb-shadow)}.range>input:active{cursor:grabbing;--thumb-color: var(--fill-color);--inner-shadow: 0 0 0 calc(var(--thumb-size)/4) inset white}.range>input:active+output{transition:0s}.range>input:hover+output{--value-background: var(--primaryColor);color:var(--value-active-color);transform:translate(var(--x-offset), 0);box-shadow:0 0 0 3px var(--value-background)}.range>output{--x-offset: calc(var(--completed) * -1% * var(--LTR));--pos: calc(((var(--value) - var(--min))/(var(--max) - var(--min))) * 100%);pointer-events:none;position:absolute;z-index:5;background:var(--value-background);border-radius:10px;padding:0 4px;top:-3ch;left:var(--pos);transform:translate(var(--x-offset), 6px);transition:all .12s ease-out, left 0s, top 0s}[dir='rtl'] .range>output{left:auto;right:var(--pos)}.range>output::after{content:var(--text-value);font:var(--value-font)}.knobs .switch{--color-bg: #444;--color-bg-on: #444;--thumb-color-off: #d75d4a;--thumb-color-on: #4ec964;--thumb-scale: 1.1;--width-multiplier: 2.5;--thumb-animation-pad: 15%;--size: 11px}.knobs .switch input:focus+div{outline:none}.switch{--color-bg: #E1E1E1;--color-bg-on: #16B5FF;--thumb-color-on: white;--thumb-color-off: var(--thumb-color-on);--thumb-scale: 1;--size: 16px;--duration: .18s;--width-multiplier: 2.5;--thumb-animation-pad: 15%;user-select:none;display:inline-flex;align-items:center}@keyframes switchMoveThumb{50%{padding:0 var(--thumb-animation-pad)}}@keyframes switchMoveThumb1{50%{padding:0 var(--thumb-animation-pad)}}.switch--textRight .switch__label{order:10;padding:0 0 0 .4em}.switch>div{cursor:pointer}.switch__label{order:0;padding-right:.4em;color:var(--label-color)}.switch__gfx{--thumb-left: 0%;--transform: translateX(calc(var(--thumb-left) * -1)) scale(var(--thumb-scale));order:5;padding:3px;position:relative;background:var(--bg, var(--color-bg));border-radius:50px;width:calc(var(--size) * var(--width-multiplier));transition:var(--duration);background-size:4px 4px}.switch__gfx::before{content:'';display:block;position:relative;left:var(--thumb-left);background:var(--thumb-color, var(--thumb-color-off));border-radius:var(--size);width:var(--size);height:var(--size);transform:var(--transform);transition:var(--duration);animation:switchMoveThumb var(--duration) ease 1}.switch input{position:absolute;opacity:0}.switch input[disabled]+div{background-image:linear-gradient(45deg, #fff 25%, transparent 25%, transparent 50%, #fff 50%, #fff 75%, transparent 75%)}.switch input:disabled ~ div{cursor:not-allowed}.switch input:indeterminate+div{--thumb-left: 50%}.switch input:checked+div{--bg: var(--color-bg-on);--thumb-left: 100%;--thumb-color: var(--thumb-color-on)}.switch input:checked+div::before{animation-name:switchMoveThumb1}.switch input:focus+div{outline:1px dotted silver}.switch input:focus:not(:focus-visible)+div{outline:none}.knobs__controls{opacity:0;text-align:right;margin:var(--side-pad)}.knobs__controls>input{color:black;margin-left:1em}label[data-type=\"color\"]>.knobs__knob__inputWrap>div{display:inline-block;border-radius:50px;overflow:hidden;width:var(--color-size);height:var(--color-size);transition:0.3s var(--in-easing);box-shadow:0px 0px 7px -2px currentColor}label[data-type=\"color\"]:hover>.knobs__knob__inputWrap>div{padding:0 1.3em}input[type=\"color\"]{-webkit-appearance:none;appearance:none;border:0;padding:0;transform:scale(2);background:none;cursor:pointer}\n"+o.styles,e.head.insertAdjacentHTML("beforeend",`<style>${t}</style>`),e.close(),this.DOM.scope=e.body.firstElementChild,this.DOM.form=this.DOM.scope.querySelector("form"),this.DOM.mainToggler=e.getElementById("knobsToggle"),this.render()},render(){this.generateIds();var t=this.knobs.reduce(((t,o)=>(o&&!e(o)&&t.push([]),t[t.length-1].push(o),t)),[[]]);this.DOM.form.querySelectorAll("fieldset").forEach((e=>e.remove()));var o=t.map(this.templates.fieldset.bind(this)).join("");this.DOM.form.insertAdjacentHTML("afterbegin",o),this.calculateGroupsHeights(),this.toggle(this.DOM.mainToggler.checked),this.resetAll()},onChange(e){var t,o=this.getKnobDataByName(e.target.name),a="input"==e.type&&o&&"range"!=o.type,r=o&&"checkbox"==o.type;o&&(r||this.settings.live)&&("input"==e.type&&a||(t={...o,value:e.target.value},n((()=>this.updateDOM(t))),"function"==typeof o.onChange&&o.onChange(e,t)))},onInput(e){var t=e.target;t.parentNode.style.setProperty("--value",t.value),t.parentNode.style.setProperty("--text-value",JSON.stringify(t.value))},setKnobChangedFlag(e,t){e&&e[(0==t?"remove":"set")+"Attribute"]("data-changed",!0)},bindEvents(){this.eventsRefs=this.eventsRefs||{onChange:e=>{this.setKnobChangedFlag(this.getKnobElm(e.target.name)),this.onChange(e)},onInput:e=>{e.target.classList.contains("toggleSection")||(this.onInput(e),this.onChange(e))},onTransitionEnd:e=>{e.target.classList.contains("fieldset__group")&&this.setIframeHeight()},onReset:this.resetAll.bind(this,null),onSubmit:this.onSubmit.bind(this),onClick:this.onClick.bind(this)};const e=new ResizeObserver((e=>this.setIframeHeight()));var{onChange:t,onInput:o,onReset:a,onSubmit:n,onClick:r,onTransitionEnd:i}=this.eventsRefs;this.DOM.form.addEventListener("change",t),this.DOM.form.addEventListener("input",o),this.DOM.form.addEventListener("reset",a),this.DOM.form.addEventListener("submit",n),this.DOM.scope.addEventListener("click",r),this.DOM.mainToggler.addEventListener("change",(e=>this.toggle(e.target.checked))),e.observe(this.DOM.form),this.DOM.form.addEventListener("transitionend",i)}},r}));
